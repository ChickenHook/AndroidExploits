package org.chickenhook.androidexploits.reportOverview

import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageButton
import android.widget.ProgressBar
import androidx.recyclerview.widget.RecyclerView
import org.chickenhook.androidexploits.R

open abstract class IReportOverviewItem(
    var onClick: View.OnClickListener? = null,
    var onHelpClicked: ((String?) -> Unit)? = null
) {

    var helpText: String? = null

}

fun inflate(parent: ViewGroup, resId: Int): View {
    return LayoutInflater.from(parent.context).inflate(resId, parent, false)
}

open abstract class IReportOverviewItemViewHolder(val parent: ViewGroup, resId: Int) :
    RecyclerView.ViewHolder(inflate(parent, resId)) {

    var progressBar: ProgressBar? = null
    fun bind(item: IReportOverviewItem) {
        progressBar = itemView.findViewById(R.id.item_pb)
        itemView.findViewById<ImageButton>(R.id.item_help)?.let {button->
            item.onHelpClicked?.let {listener ->
                button.setOnClickListener {
                    listener.invoke(item.helpText)
                }
            }?: kotlin.run {
                button.visibility = View.GONE
            }
        }
        doBind(item)
    }


    protected abstract fun doBind(item: IReportOverviewItem)
}