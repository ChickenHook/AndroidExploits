package org.chickenhook.androidexploits

import androidx.recyclerview.widget.RecyclerView
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageButton
import android.widget.TextView
import org.chickenh00k.androidexploits.common.Incidence
import org.chickenhook.androidexploits.databinding.FragmentDeviceInfoBinding
import org.chickenhook.androidexploits.databinding.FragmentRepoertOverviewItemBinding
import org.chickenhook.androidexploits.reportOverview.*


/**
 * [RecyclerView.Adapter] that can display a [PlaceholderItem].
 * TODO: Replace the implementation with code for your data type.
 */
class DeviceCardReportAdapter (
    private val values: List<IReportOverviewItem>
) : RecyclerView.Adapter<IReportOverviewItemViewHolder>() {

    var onClickListener: ((pos: Int, content:String) -> Unit)? = null

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): IReportOverviewItemViewHolder {
        when(viewType) {
            MyDeviceScoreItem.TYPE_ID -> {
                return MyDeviceScoreItem.ViewHolder(
                    parent, R.layout.my_device_score_item
                )
            }
            GenericScoreItem.TYPE_ID -> {
                return GenericScoreItem.ViewHolder(
                    parent, R.layout.generic_score_item
                )
            }
            IncidencesItem.TYPE_ID -> {
                return IncidencesItem.ViewHolder(
                    parent, R.layout.incidences_item
                )
            }
            GenericScoreListItem.TYPE_ID -> {
                return GenericScoreListItem.ViewHolder(
                    parent, R.layout.generic_score_list_item
                )
            }
            GenericScoreItemSmall.TYPE_ID -> {
                return GenericScoreItemSmall.ViewHolder(
                    parent, R.layout.generic_score_item_small
                )
            }
            HistoryItem.TYPE_ID -> {
                return HistoryItem.ViewHolder(
                    parent, R.layout.history_item
                )
            }

        }
        throw java.lang.RuntimeException("Unsupported item type <$viewType>")
    }

    override fun onBindViewHolder(holder: IReportOverviewItemViewHolder, position: Int) {
        holder.bind(values[position])
//        val item = values[position]
//        holder.idView.text = item.name
//        //holder.contentView.text = item.second
//
//        holder.contentView.visibility = View.GONE
//        holder.infoButton.setOnClickListener {
//            onClickListener?.let { it1 -> it1(position, item.value) }
//        }
    }

    override fun getItemCount(): Int = values.size


    override fun getItemViewType(position: Int): Int {
        if(values[position] is MyDeviceScoreItem) {
            return MyDeviceScoreItem.TYPE_ID
        }else if(values[position] is GenericScoreItemSmall) {
            return GenericScoreItemSmall.TYPE_ID
        } else if(values[position] is GenericScoreItem) {
            return GenericScoreItem.TYPE_ID
        } else if(values[position] is IncidencesItem) {
            return IncidencesItem.TYPE_ID
        }else if(values[position] is GenericScoreListItem) {
            return GenericScoreListItem.TYPE_ID
        }else if(values[position] is HistoryItem) {
            return HistoryItem.TYPE_ID
        }
        throw java.lang.RuntimeException("Unsupported item type <${values[position]}>")
    }
}