package org.chickenhook.service

import android.app.Service
import android.content.Intent
import android.os.Binder
import android.os.Build
import android.os.IBinder
import org.chickenhook.common.DeviceInfo

class AndroidExploitsService : Service()
{

    fun collectDeviceInfo() : DeviceInfo {
        var deviceInfo = DeviceInfo()
        Build::class.java.declaredFields.forEach {field ->
            val value = field.get(null)
            value?.let {
                if(it is String)
                    deviceInfo.data[field.name] = it
            }
        }
        Build.VERSION::class.java.declaredFields.forEach {field ->
            val value = field.get(null)
            value?.let {
                if(it is String)
                    deviceInfo.data[field.name] = it
            }
        }

        return deviceInfo
    }

    override fun onBind(p0: Intent?): IBinder? {
        return ServiceBinder()
    }




    inner class ServiceBinder : Binder() {
        fun getDeviceInfo(): DeviceInfo {
            return collectDeviceInfo()
        }
    }



}